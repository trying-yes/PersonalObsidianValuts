
##  整体关系图（简化版）

```
        [ RIR ]
          ↓
   分配大段地址块
          ↓
      [ ISP / AS ]
          ↓
   分配给下级 ISP 或用户
          ↓
       [ BGP ]
   负责在全球传播这些路由信息
          ↓
      [ 路由器们 ]
   根据前缀和下一跳转发数据包
```

---

##  一、ISP（Internet Service Provider）

**互联网服务提供商**

- 就是“给你提供上网”的机构。
    
- 也就是实际拥有网络基础设施（光缆、机房、交换路由器）的运营商。
    

按规模分层：

|层级|名称|特点|
|---|---|---|
|Tier 1 ISP|全球骨干运营商（如 AT&T、NTT、Level 3）|能直接与其他 Tier 1 互联，不用买带宽|
|Tier 2 ISP|区域运营商（如各国的电信、移动、联通）|从 Tier 1 买带宽，再分发给下级|
|Tier 3 ISP|本地运营商 / 企业网络|直接面向用户|

 每个 ISP 通常对应一个或多个 **AS（自治系统）**。

---

##  二、AS（Autonomous System）

**自治系统**

> 一组“在统一路由策略下运行的网络集合”。

也就是说：

- 每个 ISP（或大型企业）会注册一个 **AS号（ASN）**；
    
- AS 内部的路由是“我说了算”；
    
- AS 之间靠 **BGP** 来交换路由。
    

例子：

|名称|AS号|
|---|---|
|Google|AS15169|
|Cloudflare|AS13335|
|中国电信|AS4134|
|日本NTT|AS2914|

---

##  三、BGP（Border Gateway Protocol）

**边界网关协议**

这是互联网“外层”最重要的协议。

> 它是不同 AS 之间“互相告诉对方我有哪些前缀”的协议。

功能：

- 每个 AS 告诉邻居“这些 IP 段归我”；
    
- 邻居再传给别的邻居；
    
- 最终形成一张全球路由表。
    

BGP 解决的是：

> “全世界数十万个自治系统，如何让彼此知道去哪能到哪？”

这就是我们前面讨论的“CIDR 广播”“前缀聚合”所在的层次。

---

##  四、RIR（Regional Internet Registry）

**区域互联网注册机构**

> 负责“IP 地址和 AS 号”的分配与管理。

全球一共有 **5 个 RIR**，分别负责不同地区：

|RIR 名称|区域|代表国家|
|---|---|---|
|ARIN|北美|美国、加拿大|
|RIPE NCC|欧洲、中东|英国、德国|
|APNIC|亚太|中国、日本、澳大利亚|
|LACNIC|拉美|巴西、阿根廷|
|AfriNIC|非洲|南非、尼日利亚|

它们接收来自 **IANA**（Internet Assigned Numbers Authority，互联网号码分配局）的上级授权。

---

##  五、IANA（Internet Assigned Numbers Authority）

**互联网号码分配局**

这是最上层的全球机构（由 ICANN 监管），  
负责：

- 把 IP 地址的大块分给 RIR；
    
- 分配全球唯一的 AS 号；
    
- 管理顶级域名（.com, .org, .cn, …）。
    

可以理解成互联网“资源分配的总司令部”。

---

##  六、它们的上下级关系总结

```
[ IANA ]
   │
   └── 分配大块地址 /8 给各 RIR
        │
        └── [ RIR ] （比如 APNIC）
              └── 分配 /12、/16 给各国家或大ISP
                    └── [ ISP / AS ]
                          └── 通过 BGP 广播路由
                                └── [ 企业 / 用户 ]
```

---

##  七、它们之间的功能分工（一句话总结表）

|名称|全称|职责|所在层级|
|---|---|---|---|
|**IANA**|Internet Assigned Numbers Authority|全球IP资源与AS号分配|顶层|
|**RIR**|Regional Internet Registry|向各地区ISP分配IP段和AS号|区域管理层|
|**ISP**|Internet Service Provider|拥有实际网络、分配地址给客户|实体运营层|
|**AS**|Autonomous System|表示一个独立的路由策略域|与ISP几乎等价|
|**BGP**|Border Gateway Protocol|AS之间交换路由信息|协议机制|
|**CIDR**|Classless Inter-Domain Routing|让地址能聚合、减少路由表|地址策略|
|**路由器**|Router|实际执行转发、查表|执行层|

---

##  八、简单一句话总结整套体系：

>  IANA 掌管资源 → RIR 分区域分配 → ISP/AS 管辖子块 →  
> 通过 BGP 在全网公布路由 → CIDR 让这些路由可以被聚合 →  
> 各路由器根据前缀查表转发。
